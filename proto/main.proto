syntax = "proto3";

option go_package = "github.com/yoRyuuuuu/typex/proto";

service Game {
    rpc Connect (ConnectRequest) returns (ConnectResponse) {}
    rpc Stream(stream Request) returns (stream Response) {}
}

message ConnectRequest {
    string name = 1;
}

message ConnectResponse {
    string token = 1;
    repeated Player player = 2;
}

message Attack {
    string text = 1;
    string id = 2;
}

message Question {
    string text = 1;
}

message Start {
    string problem = 1;
}

message Request {
    oneof action {
        Attack attack = 1;
    }
}

message Player {
    string id = 1;
    string name = 2;
    int64 health = 3;
}

message Finish {
    string winner = 1;
}

message Join {
    Player player = 1;
}

message Damage {
    // 攻撃を受けるPlayerのID
    string id = 1;
    // 体力の数値
    int64 health = 2;
}

message Response {
    oneof event {
        Question question = 1;
        Start start = 2;
        Finish finish = 3;
        Join join = 4;
        Damage damage = 5;
    }
}